<!-- Code Generated by Sidekick is for learning and experimentation purposes only. -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>New Arrivals</title>
</head>
<body>
  <div class="new-section-bg">
    <div class="new-breadcrumb">Home <span>/</span> New Arrivals</div>
    <h1 class="new-title">New Arrivals</h1>
    <p class="new-desc">
      The world's most comfortable shoes for life's everyday adventures.
    </p>
    <div class="new-controls">
      <div class="new-filter" id="filterToggle">
        <div class="filter-icon-circle">
          <svg class="filter-sliders-svg" width="32" height="32" viewBox="0 0 32 32" fill="none">
            <circle cx="16" cy="16" r="15" stroke="#23201c" stroke-width="1" fill="none" />
            <line x1="10" y1="12" x2="22" y2="12" stroke="#23201c" stroke-width="1" />
            <circle cx="13" cy="12" r="1.2" fill="#23201c" />
            <line x1="10" y1="16" x2="22" y2="16" stroke="#23201c" stroke-width="1" />
            <circle cx="19" cy="16" r="1.2" fill="#23201c" />
            <line x1="10" y1="20" x2="22" y2="20" stroke="#23201c" stroke-width="1" />
            <circle cx="16" cy="20" r="1.2" fill="#23201c" />
          </svg>
        </div>
        <span style="font-weight: 500">FILTER</span>
        <span class="new-product-count" id="productCount">(0 products)</span>
      </div>
      <select class="featured-dropdown" id="sortDropdown">
        <option value="FEATURED">FEATURED</option>
        <option value="BESTSELLING">BEST SELLING</option>
        <option value="ALPHA_AZ">ALPHABETICALLY, A-Z</option>
        <option value="ALPHA_ZA">ALPHABETICALLY, Z-A</option>
        <option value="PRICE_LOW_HIGH">PRICE, LOW TO HIGH</option>
        <option value="PRICE_HIGH_LOW">PRICE, HIGH TO LOW</option>
        <option value="DATE_OLD_NEW">DATE, OLD TO NEW</option>
        <option value="DATE_NEW_OLD">DATE, NEW TO OLD</option>
      </select>
    </div>
    <div id="filterPillsBar"></div>
    <div id="filterPanel" style="display:none;"></div>
    <div class="new-products-wrapper" id="productsGrid"></div>
  </div>
  <script>
    // Code Generated by Sidekick is for learning and experimentation purposes only.
    // Dummy product data. Replace with your data import logic.
    const newProducts = [
      {
        id: 1,
        label: "Limited",
        name: "Sneaker A",
        product_name: "Sneaker A",
        subtitle: "Sporty comfort",
        variants: [
          { colorName: "Red", colorHex: "#f00", image: "https://via.placeholder.com/220x150?text=Red", subtitle: "Vivid Red" },
          { colorName: "Blue", colorHex: "#00f", image: "https://via.placeholder.com/220x150?text=Blue", subtitle: "Cool Blue" }
        ],
        sizes: [7, 8, 9, 10],
        price: 120
      },
      {
        id: 2,
        label: "Eco",
        name: "Slip-on B",
        product_name: "Slip-on B",
        subtitle: "Lightweight casual",
        variants: [
          { colorName: "Green", colorHex: "#0f0", image: "https://via.placeholder.com/220x150?text=Green", subtitle: "Fresh Green" }
        ],
        sizes: [6, 7, 8],
        price: 95
      }
      // Add more products as needed
    ];

    let hoveredCardId = null;
    let selectedVariants = {};
    newProducts.forEach(p => { selectedVariants[p.id] = 0; });
    let sortOption = "FEATURED";
    let showFilterPanel = false;
    let labelFilter = [];
    let colorFilter = [];
    let maxPriceFilter = 500;

    const allColors = Array.from(new Set(newProducts.flatMap((p) => p.variants.map((v) => v.colorName.trim()))));
    const allLabels = Array.from(new Set(newProducts.map((p) => p.label).filter(Boolean)));

    function filterProducts() {
      return newProducts.filter(product => {
        const labelMatch = labelFilter.length === 0 || labelFilter.includes(product.label);
        const colorMatch = colorFilter.length === 0 || product.variants.some(v => colorFilter.includes(v.colorName.trim()));
        const priceMatch = product.price <= maxPriceFilter;
        return labelMatch && colorMatch && priceMatch;
      });
    }

    function sortProducts(products) {
      return [...products].sort((a, b) => {
        switch (sortOption) {
          case "PRICE_LOW_HIGH": return a.price - b.price;
          case "PRICE_HIGH_LOW": return b.price - a.price;
          case "ALPHA_AZ": return a.name.localeCompare(b.name);
          case "ALPHA_ZA": return b.name.localeCompare(a.name);
          case "DATE_NEW_OLD": return b.id - a.id;
          case "DATE_OLD_NEW": return a.id - b.id;
          default: return 0;
        }
      });
    }

    function renderProducts() {
      const productGrid = document.getElementById('productsGrid');
      productGrid.innerHTML = '';
      const filtered = filterProducts();
      const sorted = sortProducts(filtered);
      document.getElementById('productCount').textContent = `(${filtered.length} products)`;

      sorted.forEach(product => {
        const currentVariant = product.variants[selectedVariants[product.id]];
        const hasSizes = product.sizes && product.sizes.length > 0;
        const card = document.createElement('div');
        card.className = 'product-card' + (hoveredCardId === product.id ? ' hover' : '');
        card.style.position = "relative";
        card.style.overflow = "visible";
        card.onmouseenter = () => { hoveredCardId = product.id; renderProducts(); };
        card.onmouseleave = () => { hoveredCardId = null; renderProducts(); };

        if (product.label) {
          const labelSpan = document.createElement('span');
          labelSpan.className = 'product-label';
          labelSpan.textContent = product.label;
          card.appendChild(labelSpan);
        }

        const link = document.createElement('a');
        link.href = `/singleProduct/new/${product.id}`;
        const img = document.createElement('img');
        img.src = currentVariant.image;
        img.alt = `${product.name} - ${currentVariant.colorName}`;
        img.className = "product-image";
        img.draggable = false;
        link.appendChild(img);
        card.appendChild(link);

        const body = document.createElement('div');
        body.className = 'product-body';
        body.innerHTML = `
          <h3 class="product-title">${product.product_name}</h3>
          <div class="product-subtitle">${product.subtitle}</div>
          <h3 class="product-title">${product.name}</h3>
          <div class="product-subtitle">${currentVariant.subtitle}</div>
          <div class="product-price">$${product.price}</div>
        `;

        const colorsDiv = document.createElement('div');
        colorsDiv.className = 'product-colors';
        colorsDiv.onclick = (e) => e.stopPropagation();
        product.variants.forEach((variant, idx) => {
          const dot = document.createElement('span');
          dot.className = "color-dot" + (selectedVariants[product.id] === idx ? " selected" : "");
          dot.title = variant.colorName;
          dot.style.background = variant.colorHex;
          dot.onclick = (ev) => { selectedVariants[product.id] = idx; renderProducts(); ev.stopPropagation(); };
          colorsDiv.appendChild(dot);
        });
        body.appendChild(colorsDiv);
        card.appendChild(body);

        if (hoveredCardId === product.id && hasSizes) {
          const sizeFloat = document.createElement('div');
          sizeFloat.className = "size-dropdown-float";
          product.sizes.forEach(size => {
            const sizeBox = document.createElement('div');
            sizeBox.className = "size-box-float";
            sizeBox.textContent = size;
            sizeFloat.appendChild(sizeBox);
          });
          card.appendChild(sizeFloat);
        }

        productGrid.appendChild(card);
      });
    }

    function renderFilterPillsBar() {
      const bar = document.getElementById('filterPillsBar');
      bar.innerHTML = '';
      if (colorFilter.length > 0 || labelFilter.length > 0 || maxPriceFilter < 500) {
        colorFilter.forEach(color => {
          const pill = document.createElement('span');
          pill.className = "filter-pill";
          pill.textContent = color;
          const removeBtn = document.createElement('button');
          removeBtn.className = "filter-pill-remove";
          removeBtn.innerHTML = "&times;";
          removeBtn.onclick = () => { colorFilter = colorFilter.filter(c => c !== color); updateUI(); };
          pill.appendChild(removeBtn);
          bar.appendChild(pill);
        });
        labelFilter.forEach(lbl => {
          const pill = document.createElement('span');
          pill.className = "filter-pill";
          pill.textContent = lbl;
          const removeBtn = document.createElement('button');
          removeBtn.className = "filter-pill-remove";
          removeBtn.innerHTML = "&times;";
          removeBtn.onclick = () => { labelFilter = labelFilter.filter(l => l !== lbl); updateUI(); };
          pill.appendChild(removeBtn);
          bar.appendChild(pill);
        });
        if (maxPriceFilter < 500) {
          const pill = document.createElement('span');
          pill.className = "filter-pill";
          pill.textContent = `â‰¤ $${maxPriceFilter}`;
          const removeBtn = document.createElement('button');
          removeBtn.className = "filter-pill-remove";
          removeBtn.innerHTML = "&times;";
          removeBtn.onclick = () => { maxPriceFilter = 500; updateUI(); };
          pill.appendChild(removeBtn);
          bar.appendChild(pill);
        }
        const clearBtn = document.createElement('button');
        clearBtn.className = "filter-pill-clearall";
        clearBtn.textContent = "Clear all";
        clearBtn.onclick = () => { labelFilter = []; colorFilter = []; maxPriceFilter = 500; updateUI(); };
        bar.appendChild(clearBtn);
      }
    }

    function renderFilterPanel() {
      const panel = document.getElementById('filterPanel');
      panel.innerHTML = '';
      panel.style.display = showFilterPanel ? "block" : "none";
      if (showFilterPanel) {
        const labelGroup = document.createElement('div');
        labelGroup.className = 'filter-group';
        labelGroup.innerHTML = `<h4>Label:</h4>`;
        allLabels.forEach(lbl => {
          const label = document.createElement('label');
          label.innerHTML = `<input type="checkbox" ${labelFilter.includes(lbl) ? "checked" : ""}> ${lbl}`;
          label.querySelector('input').onchange = (e) => {
            if (e.target.checked) labelFilter.push(lbl);
            else labelFilter = labelFilter.filter(l => l !== lbl);
            updateUI();
          };
          labelGroup.appendChild(label);
        });
        panel.appendChild(labelGroup);

        const colorGroup = document.createElement('div');
        colorGroup.className = 'filter-group';
        colorGroup.innerHTML = `<h4>Colors:</h4>`;
        allColors.forEach(c => {
          const label = document.createElement('label');
          label.innerHTML = `<input type="checkbox" ${colorFilter.includes(c) ? "checked" : ""}> ${c}`;
          label.querySelector('input').onchange = (e) => {
            if (e.target.checked) colorFilter.push(c);
            else colorFilter = colorFilter.filter(cl => cl !== c);
            updateUI();
          };
          colorGroup.appendChild(label);
        });
        panel.appendChild(colorGroup);

        const priceGroup = document.createElement('div');
        priceGroup.className = 'filter-group';
        priceGroup.innerHTML = `<label><h4>Price: $${maxPriceFilter}</h4></label>`;
        const rangeInput = document.createElement('input');
        rangeInput.type = 'range';
        rangeInput.min = "0";
        rangeInput.max = "500";
        rangeInput.value = maxPriceFilter;
        rangeInput.oninput = (e) => { maxPriceFilter = Number(e.target.value); updateUI(); };
        priceGroup.appendChild(rangeInput);
        panel.appendChild(priceGroup);

        const applyBtn = document.createElement('button');
        applyBtn.textContent = "Apply Filters";
        applyBtn.onclick = () => { showFilterPanel = false; updateUI(); };
        panel.appendChild(applyBtn);
      }
    }

    document.getElementById('filterToggle').onclick = () => {
      showFilterPanel = !showFilterPanel;
      updateUI();
    };

    document.getElementById('sortDropdown').onchange = (e) => {
      sortOption = e.target.value;
      updateUI();
    };

    function updateUI() {
      renderFilterPillsBar();
      renderFilterPanel();
      renderProducts();
    }
    updateUI();
  </script>
</body>
</html>
